#include <linux/module.h>
#include <linux/init.h>
#include <linux/netdevice.h>
#include <linux/skbuff.h>

#define MAX_TCP 65535

static int __init skeleton_init(void) {
    pr_info("[*] loaded debug module\n");
    struct net_device* dev;
    char* interface = "eth0";
    struct sk_buff* sb = alloc_skb(MAX_TCP,GFP_KERNEL);

    if(sb) {
	    pr_info("[*] allocated skbuff\n");
	   }
    dev = first_net_device(&init_net);
    while(dev) {
	    if(!(strcmp(dev->name,interface))){
	    	pr_info("[*] identified%s\n",dev->name);
		dev->netdev_ops->ndo_start_xmit(sb,dev);
	    }
	   dev = next_net_device(dev);
    } 
    kfree_skb(sb);
    pr_info("[*] deallocated skbuff\n");
    return 0;
}

static void __exit skeleton_exit(void) {
    pr_info("[*] unloaded debug module\n");
  
}

module_init(skeleton_init);
module_exit(skeleton_exit);


MODULE_LICENSE("GPL");
